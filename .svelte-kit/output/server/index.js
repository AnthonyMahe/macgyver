import{json as e,text as t,error as r}from"@sveltejs/kit";import{HttpError as n,SvelteKitError as s,Redirect as a,ActionFailure as o}from"@sveltejs/kit/internal";import{with_request_store as i,merge_tracing as c,try_get_request_store as l}from"@sveltejs/kit/internal/server";import{a as u,b as d,c as p,r as h,o as f,d as m}from"./chunks/environment.js";import*as _ from"devalue";import{B as y,b as g,t as w,a as v,g as b,c as $,p as k,s as E,T as j,I as R}from"./chunks/shared.js";import{n as x,s as S}from"./chunks/ssr.js";import{p as q,r as O,o as T,s as P,a as A,g as U,b as C}from"./chunks/internal.js";import{parse as H,serialize as N}from"cookie";import*as L from"set-cookie-parser";function z(){let e,t;return{promise:new Promise((r,n)=>{e=r,t=n}),resolve:e,reject:t}}const I=[101,103,204,205,304],W=!!globalThis.process?.versions?.webcontainer,D=["GET","POST","PUT","PATCH","DELETE","OPTIONS","HEAD"],M=["GET","POST","HEAD"];function G(e,t){const r=[];let n;e.split(",").forEach((e,t)=>{const n=/([^/ \t]+)\/([^; \t]+)[ \t]*(?:;[ \t]*q=([0-9.]+))?/.exec(e);if(n){const[,e,s,a="1"]=n;r.push({type:e,subtype:s,q:+a,i:t})}}),r.sort((e,t)=>e.q!==t.q?t.q-e.q:"*"===e.subtype!=("*"===t.subtype)?"*"===e.subtype?1:-1:"*"===e.type!=("*"===t.type)?"*"===e.type?1:-1:e.i-t.i);let s=1/0;for(const a of t){const[e,t]=a.split("/"),o=r.findIndex(r=>!(r.type!==e&&"*"!==r.type||r.subtype!==t&&"*"!==r.subtype));-1!==o&&o<s&&(n=a,s=o)}return n}function F(e){return function(e,...t){const r=e.headers.get("content-type")?.split(";",1)[0].trim()??"";return t.includes(r.toLowerCase())}(e,"application/x-www-form-urlencoded","multipart/form-data","text/plain")}function J(e){return e}function B(e){return e instanceof n||e instanceof s?e.status:500}const V={"&":"&amp;",'"':"&quot;"},Q={"&":"&amp;","<":"&lt;"},X="[\\ud800-\\udbff](?![\\udc00-\\udfff])|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\udc00-\\udfff]",Y=new RegExp(`[${Object.keys(V).join("")}]|`+X,"g"),Z=new RegExp(`[${Object.keys(Q).join("")}]|`+X,"g");function K(e,t){const r=t?V:Q;return e.replace(t?Y:Z,e=>2===e.length?e:r[e]??`&#${e.charCodeAt(0)};`)}function ee(e,r){return t(`${r} method not allowed`,{status:405,headers:{allow:te(e).join(", ")}})}function te(e){const t=D.filter(t=>t in e);return"GET"in e&&!("HEAD"in e)&&t.push("HEAD"),t}function re(e){return`__sveltekit_${e.version_hash}`}function ne(e,r,n){let s=e.templates.error({status:r,message:K(n)});return t(s,{headers:{"content-type":"text/html; charset=utf-8"},status:r})}async function se(t,r,s,a){var o;const i=B(a=a instanceof n?a:(o=a)instanceof Error||o&&o.name&&o.message?o:new Error(JSON.stringify(o))),c=await ae(t,r,s,a),l=G(t.request.headers.get("accept")||"text/html",["application/json","text/html"]);return t.isDataRequest||"application/json"===l?e(c,{status:i}):ne(s,i,c.message)}async function ae(e,t,r,a){if(a instanceof n)return{message:"Unknown Error",...a.body};const o=B(a),c=function(e){return e instanceof s?e.text:"Internal Error"}(a);return await i({event:e,state:t},()=>r.hooks.handleError({error:a,event:e,status:o,message:c}))??{message:c}}function oe(e,t){return new Response(void 0,{status:e,headers:{location:t}})}function ie(e,t){return t.path?`Data returned from \`load\` while rendering ${e.route.id} is not serializable: ${t.message} (${t.path}). If you need to serialize/deserialize custom types, use transport hooks: https://svelte.dev/docs/kit/hooks#Universal-hooks-transport.`:""===t.path?`Data returned from \`load\` while rendering ${e.route.id} is not a plain object`:t.message}function ce(e){const t={};return e.uses&&e.uses.dependencies.size>0&&(t.dependencies=Array.from(e.uses.dependencies)),e.uses&&e.uses.search_params.size>0&&(t.search_params=Array.from(e.uses.search_params)),e.uses&&e.uses.params.size>0&&(t.params=Array.from(e.uses.params)),e.uses?.parent&&(t.parent=1),e.uses?.route&&(t.route=1),e.uses?.url&&(t.url=1),t}function le(e,t){return e._.prerendered_routes.has(t)||"/"===t.at(-1)&&e._.prerendered_routes.has(t.slice(0,-1))}function ue(e){const t=e?.split("/"),r=t?.at(-1);return r?r.split(".").slice(0,-1).join("."):"unknown"}function de(e){return e.filter(e=>null!=e)}const pe="/__data.json",he=".html__data.json";function fe(e){return e.endsWith(".html")?e.replace(/\.html$/,he):e.replace(/\/$/,"")+pe}const me="/__route.js";function _e(e){return e.replace(/\/$/,"")+me}const ye={spanContext:()=>ge,setAttribute(){return this},setAttributes(){return this},addEvent(){return this},setStatus(){return this},updateName(){return this},end(){return this},isRecording:()=>!1,recordException(){return this},addLink(){return this},addLinks(){return this}},ge={traceId:"",spanId:"",traceFlags:0};async function we({name:e,attributes:t,fn:r}){return r(ye)}function ve(e){return"application/json"===G(e.request.headers.get("accept")??"*/*",["application/json","text/html"])&&"POST"===e.request.method}function be(e){return e instanceof o?new Error('Cannot "throw fail()". Use "return fail()"'):e}function $e(e){return ke({type:"redirect",status:e.status,location:e.location})}function ke(t,r){return e(t,r)}function Ee(e){if(e.default&&Object.keys(e).length>1)throw new Error("When using named actions, the default action cannot be used. See the docs for more info: https://svelte.dev/docs/kit/form-actions#named-actions")}async function je(e,t,r){const n=new URL(e.request.url);let a="default";for(const s of n.searchParams)if(s[0].startsWith("/")){if(a=s[0].slice(1),"default"===a)throw new Error('Cannot use reserved action name "default"');break}const l=r[a];if(!l)throw new s(404,"Not Found",`No action with name '${a}' found`);if(!F(e.request))throw new s(415,"Unsupported Media Type",`Form actions expect form-encoded data â€” received ${e.request.headers.get("content-type")}`);return we({name:"sveltekit.form_action",attributes:{"http.route":e.route.id||"unknown"},fn:async r=>{const n=c(e,r),s=await i({event:n,state:t},()=>l(n));return s instanceof o&&r.setAttributes({"sveltekit.form_action.result.type":"failure","sveltekit.form_action.result.status":s.status}),s}})}function Re(e,t,r){const n=Object.fromEntries(Object.entries(r).map(([e,t])=>[e,t.encode]));return xe(e,e=>_.stringify(e,n),t)}function xe(e,t,r){try{return t(e)}catch(n){const t=n;if(e instanceof Response)throw new Error(`Data returned from action inside ${r} is not serializable. Form actions need to return plain objects or fail(). E.g. return { success: true } or return fail(400, { message: "invalid" });`);if("path"in t){let e=`Data returned from action inside ${r} is not serializable: ${t.message}`;throw""!==t.path&&(e+=` (data.${t.path})`),new Error(e)}throw t}}function Se(){let e=-1,t=-1;const r=[];return{iterate:(e=e=>e)=>({[Symbol.asyncIterator]:()=>({next:async()=>{const n=r[++t];if(!n)return{value:null,done:!0};const s=await n.promise;return{value:e(s),done:!1}}})}),add:t=>{r.push(z()),t.then(t=>{r[++e].resolve(t)})}}}function qe(e,t,r){let n=1,s=-1;const a=Se(),o=re(r),i=[];return{set_max_nodes(e){s=e},add_node(s,c){try{if(!c)return void(i[s]="null");const u={type:"data",data:c.data,uses:ce(c)};c.slash&&(u.slash=c.slash),i[s]=_.uneval(u,(l=s,function s(i){if("function"==typeof i?.then){const c=n++,u=i.then(e=>({data:e})).catch(async n=>({error:await ae(e,t,r,n)})).then(async({data:n,error:a})=>{let i;try{i=_.uneval(a?[,a]:[n],s)}catch{a=await ae(e,t,r,new Error(`Failed to serialize promise while rendering ${e.route.id}`)),n=void 0,i=_.uneval([,a],s)}return{index:l,str:`${o}.resolve(${c}, ${i.includes("app.decode")?`(app) => ${i}`:`() => ${i}`})`}});return a.add(u),`${o}.defer(${c})`}for(const e in r.hooks.transport){const t=r.hooks.transport[e].encode(i);if(t)return`app.decode('${e}', ${_.uneval(t,s)})`}}))}catch(u){throw u.path=u.path.slice(1),new Error(ie(e,u))}var l},get_data(e){const t=`<script${e.script_needs_nonce?` nonce="${e.nonce}"`:""}>`;return{data:`[${de(s>-1?i.slice(0,s):i).join(",")}]`,chunks:n>1?a.iterate(({index:e,str:r})=>s>-1&&e>=s?"":t+r+"<\/script>\n"):null}}}}function Oe(e,t,r){let n=1;const s=Se(),a={...Object.fromEntries(Object.entries(r.hooks.transport).map(([e,t])=>[e,t.encode])),Promise:o=>{if("function"!=typeof o?.then)return;const i=n++;let c="data";const l=o.catch(async n=>(c="error",ae(e,t,r,n))).then(async n=>{let s;try{s=_.stringify(n,a)}catch{const n=await ae(e,t,r,new Error(`Failed to serialize promise while rendering ${e.route.id}`));c="error",s=_.stringify(n,a)}return`{"type":"chunk","id":${i},"${c}":${s}}\n`});return s.add(l),i}},o=[];return{add_node(t,r){try{if(!r)return void(o[t]="null");if("error"===r.type||"skip"===r.type)return void(o[t]=JSON.stringify(r));o[t]=`{"type":"data","data":${_.stringify(r.data,a)},"uses":${JSON.stringify(ce(r))}${r.slash?`,"slash":${JSON.stringify(r.slash)}`:""}}`}catch(n){throw n.path="data"+n.path,new Error(ie(e,n))}},get_data:()=>({data:`{"type":"data","nodes":[${o.join(",")}]}\n`,chunks:n>1?s.iterate():null})}}const Te=new URL("sveltekit-internal://");function Pe(e,t){if("/"===t[0]&&"/"===t[1])return t;let r=new URL(e,Te);return r=new URL(t,r),r.protocol===Te.protocol?r.pathname+r.search+r.hash:r.href}function Ae(e,t){return"/"===e||"ignore"===t?e:"never"===t?e.endsWith("/")?e.slice(0,-1):e:"always"!==t||e.endsWith("/")?e:e+"/"}function Ue(e){for(const t in e)e[t]=decodeURIComponent(e[t]);return e}function Ce(e){He(e);for(const t of["search","searchParams"])Object.defineProperty(e,t,{get(){throw new Error(`Cannot access url.${t} on a page with prerendering enabled`)}})}function He(e){e[Symbol.for("nodejs.util.inspect.custom")]=(t,r,n)=>n(new URL(e),r)}async function Ne({event:e,event_state:t,state:r,node:n,parent:s}){if(!n?.server)return null;let a=!0;const o={dependencies:new Set,params:new Set,parent:!1,route:!1,url:!1,search_params:new Set},l=n.server.load,u=n.server.trailingSlash;if(!l)return{type:"data",data:null,uses:o,slash:u};const d=function(e,t,r,n=!1){const s=new URL(e);Object.defineProperty(s,"searchParams",{value:new Proxy(s.searchParams,{get(e,n){if("get"===n||"getAll"===n||"has"===n)return t=>(r(t),e[n](t));t();const s=Reflect.get(e,n);return"function"==typeof s?s.bind(e):s}}),enumerable:!0,configurable:!0});const a=["href","pathname","search","toString","toJSON"];n&&a.push("hash");for(const o of a)Object.defineProperty(s,o,{get:()=>(t(),e[o]),enumerable:!0,configurable:!0});return s[Symbol.for("nodejs.util.inspect.custom")]=(t,r,n)=>n(e,r),s.searchParams[Symbol.for("nodejs.util.inspect.custom")]=(t,r,n)=>n(e.searchParams,r),n||function(e){He(e),Object.defineProperty(e,"hash",{get(){throw new Error("Cannot access event.url.hash. Consider using `page.url.hash` inside a component instead")}})}(s),s}(e.url,()=>{a&&(o.url=!0)},e=>{a&&o.search_params.add(e)});return r.prerendering&&Ce(d),{type:"data",data:await we({name:"sveltekit.load",attributes:{"sveltekit.load.node_id":n.server_id||"unknown","sveltekit.load.node_type":ue(n.server_id),"http.route":e.route.id||"unknown"},fn:async r=>{const n=c(e,r);return await i({event:n,state:t},()=>l.call(null,{...n,fetch:(t,r)=>(new URL(t instanceof Request?t.url:t,e.url),e.fetch(t,r)),depends:(...t)=>{for(const r of t){const{href:t}=new URL(r,e.url);o.dependencies.add(t)}},params:new Proxy(e.params,{get:(e,t)=>(a&&o.params.add(t),e[t])}),parent:async()=>(a&&(o.parent=!0),s()),route:new Proxy(e.route,{get:(e,t)=>(a&&(o.route=!0),e[t])}),url:d,untrack(e){a=!1;try{return e()}finally{a=!0}}}))}})??null,uses:o,slash:u}}async function Le({event:e,event_state:t,fetched:r,node:n,parent:s,server_data_promise:a,state:o,resolve_opts:l,csr:u}){const d=await a,p=n?.universal?.load;return p?await we({name:"sveltekit.load",attributes:{"sveltekit.load.node_id":n.universal_id||"unknown","sveltekit.load.node_type":ue(n.universal_id),"http.route":e.route.id||"unknown"},fn:async n=>{const a=c(e,n);return await i({event:a,state:t},()=>p.call(null,{url:e.url,params:e.params,data:d?.data??null,route:e.route,fetch:ze(e,o,r,u,l),setHeaders:e.setHeaders,depends:()=>{},parent:s,untrack:e=>e(),tracing:a.tracing}))}})??null:d?.data??null}function ze(e,t,r,n,s){return(a,o)=>{const i=(async(a,o)=>{const i=a instanceof Request&&a.body?a.clone().body:null,c=a instanceof Request&&[...a.headers].length?new Headers(a.headers):o?.headers;let l=await e.fetch(a,o);const u=new URL(a instanceof Request?a.url:a,e.url),d=u.origin===e.url.origin;let p,h;if(d)t.prerendering&&(p={response:l,body:null},t.prerendering.dependencies.set(u.pathname,p));else if("https:"===u.protocol||"http:"===u.protocol)if("no-cors"===(a instanceof Request?a.mode:o?.mode??"cors"))l=new Response("",{status:l.status,statusText:l.statusText,headers:l.headers});else{const t=l.headers.get("access-control-allow-origin");if(!t||t!==e.url.origin&&"*"!==t)throw new Error(`CORS error: ${t?"Incorrect":"No"} 'Access-Control-Allow-Origin' header is present on the requested resource`)}const f=new Proxy(l,{get(t,n,s){async function l(n,s){const l=Number(t.status);if(isNaN(l))throw new Error(`response.status is not a number. value: "${t.status}" type: ${typeof t.status}`);r.push({url:d?u.href.slice(e.url.origin.length):u.href,method:e.request.method,request_body:a instanceof Request&&i?await Ie(i):o?.body,request_headers:c,response_body:n,response:t,is_b64:s})}if("body"===n){if(null===t.body)return null;if(h)return h;const[e,r]=t.body.tee();return(async()=>{let t=new Uint8Array;for await(const r of e){const e=new Uint8Array(t.length+r.length);e.set(t,0),e.set(r,t.length),t=e}p&&(p.body=new Uint8Array(t)),l(g(t),!0)})(),h=r}if("arrayBuffer"===n)return async()=>{const e=await t.arrayBuffer(),r=new Uint8Array(e);return p&&(p.body=r),e instanceof ArrayBuffer&&await l(g(r),!0),e};async function f(){const e=await t.text();if(""!==e||!I.includes(t.status))return e&&"string"!=typeof e||await l(e,!1),p&&(p.body=e),e;await l(void 0,!1)}return"text"===n?f:"json"===n?async()=>{const e=await f();return e?JSON.parse(e):void 0}:Reflect.get(t,n,t)}});if(n){const t=l.headers.get;l.headers.get=r=>{const n=r.toLowerCase(),a=t.call(l.headers,n);if(a&&!n.startsWith("x-sveltekit-")&&!s.filterSerializedResponseHeaders(n,a))throw new Error(`Failed to get response header "${n}" â€” it must be included by the \`filterSerializedResponseHeaders\` option: https://svelte.dev/docs/kit/hooks#Server-hooks-handle (at ${e.route.id})`);return a}}return f})(a,o);return i.catch(()=>{}),i}}async function Ie(e){let t="";const r=e.getReader();for(;;){const{done:e,value:n}=await r.read();if(e)break;t+=w.decode(n)}return t}const We=[];function De(e,t=x){let r;const n=new Set;function s(t){if(S(e,t)&&(e=t,r)){const t=!We.length;for(const r of n)r[1](),We.push(r,e);if(t){for(let e=0;e<We.length;e+=2)We[e][0](We[e+1]);We.length=0}}}function a(t){s(t(e))}return{set:s,update:a,subscribe:function(o,i=x){const c=[o,i];return n.add(c),1===n.size&&(r=t(s,a)||x),o(e),()=>{n.delete(c),0===n.size&&r&&(r(),r=null)}}}}function Me(...e){let t=5381;for(const r of e)if("string"==typeof r){let e=r.length;for(;e;)t=33*t^r.charCodeAt(--e)}else{if(!ArrayBuffer.isView(r))throw new TypeError("value must be a string or TypedArray");{const e=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);let n=e.length;for(;n;)t=33*t^e[--n]}}return(t>>>0).toString(36)}const Ge={"<":"\\u003C","\u2028":"\\u2028","\u2029":"\\u2029"},Fe=new RegExp(`[${Object.keys(Ge).join("")}]`,"g"),Je=JSON.stringify;function Be(e){Qe[0]||function(){function e(e){return 4294967296*(e-Math.floor(e))}let t=2;for(let r=0;r<64;t++){let n=!0;for(let e=2;e*e<=t;e++)if(t%e===0){n=!1;break}n&&(r<8&&(Ve[r]=e(t**.5)),Qe[r]=e(t**(1/3)),r++)}}();const t=Ve.slice(0),r=function(e){const t=v.encode(e),r=8*t.length,n=512*Math.ceil((r+65)/512),s=new Uint8Array(n/8);s.set(t),s[t.length]=128,Xe(s);const a=new Uint32Array(s.buffer);return a[a.length-2]=Math.floor(r/4294967296),a[a.length-1]=r,a}(e);for(let s=0;s<r.length;s+=16){const e=r.subarray(s,s+16);let n,a,o,i=t[0],c=t[1],l=t[2],u=t[3],d=t[4],p=t[5],h=t[6],f=t[7];for(let t=0;t<64;t++)t<16?n=e[t]:(a=e[t+1&15],o=e[t+14&15],n=e[15&t]=(a>>>7^a>>>18^a>>>3^a<<25^a<<14)+(o>>>17^o>>>19^o>>>10^o<<15^o<<13)+e[15&t]+e[t+9&15]|0),n=n+f+(d>>>6^d>>>11^d>>>25^d<<26^d<<21^d<<7)+(h^d&(p^h))+Qe[t],f=h,h=p,p=d,d=u+n|0,u=l,l=c,c=i,i=n+(c&l^u&(c^l))+(c>>>2^c>>>13^c>>>22^c<<30^c<<19^c<<10)|0;t[0]=t[0]+i|0,t[1]=t[1]+c|0,t[2]=t[2]+l|0,t[3]=t[3]+u|0,t[4]=t[4]+d|0,t[5]=t[5]+p|0,t[6]=t[6]+h|0,t[7]=t[7]+f|0}const n=new Uint8Array(t.buffer);return Xe(n),btoa(String.fromCharCode(...n))}const Ve=new Uint32Array(8),Qe=new Uint32Array(64);function Xe(e){for(let t=0;t<e.length;t+=4){const r=e[t+0],n=e[t+1],s=e[t+2],a=e[t+3];e[t+0]=a,e[t+1]=s,e[t+2]=n,e[t+3]=r}}const Ye=new Uint8Array(16),Ze=new Set(["self","unsafe-eval","unsafe-hashes","unsafe-inline","none","strict-dynamic","report-sample","wasm-unsafe-eval","script"]),Ke=/^(nonce|sha\d\d\d)-/;class et{#e;#t;#r;#n;#s;#a;#o;#i;#c;#l;#u;#d;#p;#h;#f;constructor(e,t,r){this.#e=e,this.#c=t;const n=this.#c;this.#l=[],this.#u=[],this.#d=[],this.#p=[],this.#h=[];const s=n["script-src"]||n["default-src"],a=n["script-src-elem"],o=n["style-src"]||n["default-src"],i=n["style-src-attr"],c=n["style-src-elem"],l=e=>!!e&&!e.some(e=>"unsafe-inline"===e);this.#r=l(s),this.#n=l(a),this.#a=l(o),this.#o=l(i),this.#i=l(c),this.#t=this.#r||this.#n,this.#s=this.#a||this.#o||this.#i,this.script_needs_nonce=this.#t&&!this.#e,this.style_needs_nonce=this.#s&&!this.#e,this.#f=r}add_script(e){if(!this.#t)return;const t=this.#e?`sha256-${Be(e)}`:`nonce-${this.#f}`;this.#r&&this.#l.push(t),this.#n&&this.#u.push(t)}add_style(e){if(!this.#s)return;const t=this.#e?`sha256-${Be(e)}`:`nonce-${this.#f}`;if(this.#a&&this.#d.push(t),this.#o&&this.#p.push(t),this.#i){const e="sha256-9OlNO0DNEeaVzHL4RZwCLsBHA8WBQ8toBp/4F5XV2nc=",r=this.#c;!r["style-src-elem"]||r["style-src-elem"].includes(e)||this.#h.includes(e)||this.#h.push(e),t!==e&&this.#h.push(t)}}get_header(e=!1){const t=[],r={...this.#c};this.#d.length>0&&(r["style-src"]=[...r["style-src"]||r["default-src"]||[],...this.#d]),this.#p.length>0&&(r["style-src-attr"]=[...r["style-src-attr"]||[],...this.#p]),this.#h.length>0&&(r["style-src-elem"]=[...r["style-src-elem"]||[],...this.#h]),this.#l.length>0&&(r["script-src"]=[...r["script-src"]||r["default-src"]||[],...this.#l]),this.#u.length>0&&(r["script-src-elem"]=[...r["script-src-elem"]||[],...this.#u]);for(const n in r){if(e&&("frame-ancestors"===n||"report-uri"===n||"sandbox"===n))continue;const s=r[n];if(!s)continue;const a=[n];Array.isArray(s)&&s.forEach(e=>{Ze.has(e)||Ke.test(e)?a.push(`'${e}'`):a.push(e)}),t.push(a.join(" "))}return t.join("; ")}}class tt extends et{get_meta(){const e=this.get_header(!0);if(e)return`<meta http-equiv="content-security-policy" content="${K(e,!0)}">`}}class rt extends et{constructor(e,t,r){if(super(e,t,r),Object.values(t).filter(e=>!!e).length>0){const e=t["report-to"]?.length??!1,r=t["report-uri"]?.length??!1;if(!e&&!r)throw Error("`content-security-policy-report-only` must be specified with either the `report-to` or `report-uri` directives, or both")}}}class nt{nonce=function(){return crypto.getRandomValues(Ye),btoa(String.fromCharCode(...Ye))}();csp_provider;report_only_provider;constructor({mode:e,directives:t,reportOnly:r},{prerender:n}){const s="hash"===e||"auto"===e&&n;this.csp_provider=new tt(s,t,this.nonce),this.report_only_provider=new rt(s,r,this.nonce)}get script_needs_nonce(){return this.csp_provider.script_needs_nonce||this.report_only_provider.script_needs_nonce}get style_needs_nonce(){return this.csp_provider.style_needs_nonce||this.report_only_provider.style_needs_nonce}add_script(e){this.csp_provider.add_script(e),this.report_only_provider.add_script(e)}add_style(e){this.csp_provider.add_style(e),this.report_only_provider.add_style(e)}}function st(e,t,r){const n={},s=e.slice(1),a=s.filter(e=>void 0!==e);let o=0;for(let i=0;i<t.length;i+=1){const e=t[i];let c=s[i-o];if(e.chained&&e.rest&&o&&(c=s.slice(i-o,i+1).filter(e=>e).join("/"),o=0),void 0!==c){if(!e.matcher||r[e.matcher](c)){n[e.name]=c;const r=t[i+1],l=s[i+1];r&&!r.rest&&r.optional&&l&&e.chained&&(o=0),r||l||Object.keys(n).length!==a.length||(o=0);continue}if(!e.optional||!e.chained)return;o++}else e.rest&&(n[e.name]="")}if(!o)return n}function at(e,t,r){const{errors:n,layouts:s,leaf:a}=e,o=[...n,...s.map(e=>e?.[1]),a[1]].filter(e=>"number"==typeof e).map(e=>`'${e}': () => ${ot(r._.client.nodes?.[e],t)}`).join(",\n\t\t");return[`{\n\tid: ${Je(e.id)}`,`errors: ${Je(e.errors)}`,`layouts: ${Je(e.layouts)}`,`leaf: ${Je(e.leaf)}`,`nodes: {\n\t\t${o}\n\t}\n}`].join(",\n\t")}function ot(e,t){if(!e)return"Promise.resolve({})";if("/"===e[0])return`import('${e}')`;if(""!==u)return`import('${u}/${e}')`;let r=b(t.pathname,`${d}/${e}`);return"."!==r[0]&&(r=`./${r}`),`import('${r}')`}function it(e,r,n,s){const a=new Headers({"content-type":"application/javascript; charset=utf-8"});if(e){const o=at(e,n,s),i=`${function(e,t,r){const{errors:n,layouts:s,leaf:a}=e;let o="";for(const i of[...n,...s.map(e=>e?.[1]),a[1]]){if("number"!=typeof i)continue;const e=r._.client.css?.[i];for(const t of e??[])o+=`'${u||d}/${t}',`}return o?`${ot(r._.client.start,t)}.then(x => x.load_css([${o}]));`:""}(e,n,s)}\nexport const route = ${o}; export const params = ${JSON.stringify(r)};`;return{response:t(i,{headers:a}),body:i}}return{response:t("",{headers:a}),body:""}}const ct={...{subscribe:De(false,undefined).subscribe},check:()=>!1};async function lt({branch:e,fetched:r,options:n,manifest:s,state:a,page_config:o,status:c,error:l=null,event:y,event_state:g,resolve_opts:w,action_result:b,data_serializer:k}){if(a.prerendering){if("nonce"===n.csp.mode)throw new Error('Cannot use prerendering if config.kit.csp.mode === "nonce"');if(n.app_template_contains_nonce)throw new Error("Cannot use prerendering if page template contains %sveltekit.nonce%")}const{client:E}=s._,j=new Set(E.imports),R=new Set(E.stylesheets),x=new Set(E.fonts),S=new Set,O=new Set,T=new Map;let P;const A="success"===b?.type||"failure"===b?.type?b.data??null:null;let U=d,C=u,H=Je(d);if(a.prerendering?.fallback)n.hash_routing&&(H="new URL('.', location).pathname.slice(0, -1)");else{const e=y.url.pathname.slice(d.length).split("/").slice(2);U=e.map(()=>"..").join("/")||".",H=`new URL(${Je(U)}, location).pathname.slice(0, -1)`,(!u||"/"===u[0]&&"/_svelte_kit_assets"!==u)&&(C=U)}if(o.ssr){const t={stores:{page:De(null),navigating:De(null),updated:ct},constructors:await Promise.all(e.map(({node:e})=>{if(!e.component)throw new Error(`Missing +page.svelte component for route ${y.route.id}`);return e.component()})),form:A};let r={};for(let n=0;n<e.length;n+=1)r={...r,...e[n].data},t[`data_${n}`]=r;t.page={error:l,params:y.params,route:y.route,status:c,url:y.url,data:r,form:A,state:{}};const s={context:new Map([["__request__",{page:t.page}]])};globalThis.fetch;try{P=await i({event:y,state:g},async()=>{h&&f({base:U,assets:C});const e=n.root.render(t,s),r=n.async&&"then"in e?e.then(e=>e):e;n.async&&m();const{head:a,html:o,css:i}=n.async?await r:r;return{head:a,html:o,css:i}})}finally{m()}for(const{node:n}of e){for(const e of n.imports)j.add(e);for(const e of n.stylesheets)R.add(e);for(const e of n.fonts)x.add(e);n.inline_styles&&!E.inline&&Object.entries(await n.inline_styles()).forEach(([e,t])=>T.set(e,t))}}else P={head:"",html:"",css:{code:"",map:null}};let N="",L=P.html;const z=new nt(n.csp,{prerender:!!a.prerendering}),I=e=>e.startsWith("/")?d+e:`${C}/${e}`,W=E.inline?E.inline?.style:Array.from(T.values()).join("\n");if(W){const e=[];z.style_needs_nonce&&e.push(` nonce="${z.nonce}"`),z.add_style(W),N+=`\n\t<style${e.join("")}>${W}</style>`}for(const t of R){const e=I(t),r=['rel="stylesheet"'];T.has(t)?r.push("disabled",'media="(max-width: 0)"'):w.preload({type:"css",path:e})&&S.add(`<${encodeURI(e)}>; rel="preload"; as="style"; nopush`),N+=`\n\t\t<link href="${e}" ${r.join(" ")}>`}for(const t of x){const e=I(t);if(w.preload({type:"font",path:e})){const r=t.slice(t.lastIndexOf(".")+1);O.add(`<link rel="preload" as="font" type="font/${r}" href="${e}" crossorigin>`),S.add(`<${encodeURI(e)}>; rel="preload"; as="font"; type="font/${r}"; crossorigin; nopush`)}}const D=re(n),{data:M,chunks:G}=k.get_data(z);if(o.ssr&&o.csr&&(L+=`\n\t\t\t${r.map(e=>function(e,t,r=!1){const n={};let s=null,a=null,o=!1;for(const[u,d]of e.response.headers)t(u,d)&&(n[u]=d),"cache-control"===u?s=d:"age"===u?a=d:"vary"===u&&"*"===d.trim()&&(o=!0);const i={status:e.response.status,statusText:e.response.statusText,headers:n,body:e.response_body},c=JSON.stringify(i).replace(Fe,e=>Ge[e]),l=['type="application/json"',"data-sveltekit-fetched",`data-url="${K(e.url,!0)}"`];if(e.is_b64&&l.push("data-b64"),e.request_headers||e.request_body){const t=[];e.request_headers&&t.push([...new Headers(e.request_headers)].join(",")),e.request_body&&t.push(e.request_body),l.push(`data-hash="${Me(...t)}"`)}if(!r&&"GET"===e.method&&s&&!o){const e=/s-maxage=(\d+)/g.exec(s)??/max-age=(\d+)/g.exec(s);if(e){const t=+e[1]-+(a??"0");l.push(`data-ttl="${t}"`)}}return`<script ${l.join(" ")}>${c}<\/script>`}(e,w.filterSerializedResponseHeaders,!!a.prerendering)).join("\n\t\t\t")}`),o.csr){const t=s._.client.routes?.find(e=>e.id===y.route.id)??null;if(E.uses_env_dynamic_public&&a.prerendering&&j.add(`${p}/env.js`),!E.inline){const e=Array.from(j,e=>I(e)).filter(e=>w.preload({type:"js",path:e}));for(const t of e)S.add(`<${encodeURI(t)}>; rel="modulepreload"; nopush`),"modulepreload"!==n.preload_strategy?N+=`\n\t\t<link rel="preload" as="script" crossorigin="anonymous" href="${t}">`:O.add(`<link rel="modulepreload" href="${t}">`)}if(a.prerendering&&O.size>0&&(N+=Array.from(O).map(e=>`\n\t\t${e}`).join("")),s._.client.routes&&a.prerendering&&!a.prerendering.fallback){const e=_e(y.url.pathname);a.prerendering.dependencies.set(e,it(t,y.params,new URL(e,y.url),s))}const r=[],i=E.uses_env_dynamic_public&&a.prerendering,d=[`base: ${H}`];if(u&&d.push(`assets: ${Je(u)}`),E.uses_env_dynamic_public&&d.push(`env: ${i?"null":Je(q)}`),G){r.push("const deferred = new Map();"),d.push("defer: (id) => new Promise((fulfil, reject) => {\n\t\t\t\t\t\t\tdeferred.set(id, { fulfil, reject });\n\t\t\t\t\t\t})");let e="";Object.keys(n.hooks.transport).length>0&&(e=E.inline?`const app = __sveltekit_${n.version_hash}.app.app;`:E.app?`const app = await import(${Je(I(E.app))});`:`const { app } = await import(${Je(I(E.start))});`);const t=e?`${e}\n\t\t\t\t\t\t\tconst [data, error] = fn(app);`:"const [data, error] = fn();";d.push(`resolve: async (id, fn) => {\n\t\t\t\t\t\t\t${t}\n\n\t\t\t\t\t\t\tconst try_to_resolve = () => {\n\t\t\t\t\t\t\t\tif (!deferred.has(id)) {\n\t\t\t\t\t\t\t\t\tsetTimeout(try_to_resolve, 0);\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tconst { fulfil, reject } = deferred.get(id);\n\t\t\t\t\t\t\t\tdeferred.delete(id);\n\t\t\t\t\t\t\t\tif (error) reject(error);\n\t\t\t\t\t\t\t\telse fulfil(data);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttry_to_resolve();\n\t\t\t\t\t\t}`)}r.push(`${D} = {\n\t\t\t\t\t\t${d.join(",\n\t\t\t\t\t\t")}\n\t\t\t\t\t};`);const h=["element"];if(r.push("const element = document.currentScript.parentElement;"),o.ssr){const r={form:"null",error:"null"};A&&(r.form=function(e,t,r){const n=e=>{for(const t in r){const s=r[t].encode(e);if(s)return`app.decode('${t}', ${_.uneval(s,n)})`}};return xe(e,e=>_.uneval(e,n),t)}(A,y.route.id,n.hooks.transport)),l&&(r.error=_.uneval(l));const a=[`node_ids: [${e.map(({node:e})=>e.index).join(", ")}]`,`data: ${M}`,`form: ${r.form}`,`error: ${r.error}`];if(200!==c&&a.push(`status: ${c}`),s._.client.routes){if(t){const e=at(t,y.url,s).replaceAll("\n","\n\t\t\t\t\t\t\t");a.push(`params: ${_.uneval(y.params)}`,`server_route: ${e}`)}}else n.embedded&&a.push(`params: ${_.uneval(y.params)}`,`route: ${Je(y.route)}`);const o="\t".repeat(i?7:6);h.push(`{\n${o}\t${a.join(`,\n${o}\t`)}\n${o}}`)}const{remote_data:f}=g;let m="";if(f){const e={};for(const[r,n]of f)if(r.id)for(const t in n)e[$(r.id,t)]=await n[t];const t=e=>{for(const r in n.hooks.transport){const s=n.hooks.transport[r].encode(e);if(s)return`app.decode('${r}', ${_.uneval(s,t)})`}};m=`${D}.data = ${_.uneval(e,t)};\n\n\t\t\t\t\t\t`}const v=E.inline?`${E.inline.script}\n\n\t\t\t\t\t${m}${D}.app.start(${h.join(", ")});`:E.app?`Promise.all([\n\t\t\t\t\t\timport(${Je(I(E.start))}),\n\t\t\t\t\t\timport(${Je(I(E.app))})\n\t\t\t\t\t]).then(([kit, app]) => {\n\t\t\t\t\t\t${m}kit.start(app, ${h.join(", ")});\n\t\t\t\t\t});`:`import(${Je(I(E.start))}).then((app) => {\n\t\t\t\t\t\t${m}app.start(${h.join(", ")})\n\t\t\t\t\t});`;if(i?r.push(`import(${Je(`${U}/${p}/env.js`)}).then(({ env }) => {\n\t\t\t\t\t\t${D}.env = env;\n\n\t\t\t\t\t\t${v.replace(/\n/g,"\n\t")}\n\t\t\t\t\t});`):r.push(v),n.service_worker){let e="";if(null!=n.service_worker_options){const t={...n.service_worker_options};e=`, ${Je(t)}`}r.push(`if ('serviceWorker' in navigator) {\n\t\t\t\t\t\taddEventListener('load', function () {\n\t\t\t\t\t\t\tnavigator.serviceWorker.register('${I("service-worker.js")}'${e});\n\t\t\t\t\t\t});\n\t\t\t\t\t}`)}const b=`\n\t\t\t\t{\n\t\t\t\t\t${r.join("\n\n\t\t\t\t\t")}\n\t\t\t\t}\n\t\t\t`;z.add_script(b),L+=`\n\t\t\t<script${z.script_needs_nonce?` nonce="${z.nonce}"`:""}>${b}<\/script>\n\t\t`}const F=new Headers({"x-sveltekit-page":"true","content-type":"text/html"});if(a.prerendering){const e=[],t=z.csp_provider.get_meta();t&&e.push(t),a.prerendering.cache&&e.push(`<meta http-equiv="cache-control" content="${a.prerendering.cache}">`),e.length>0&&(N=e.join("\n")+N)}else{const e=z.csp_provider.get_header();e&&F.set("content-security-policy",e);const t=z.report_only_provider.get_header();t&&F.set("content-security-policy-report-only",t),S.size&&F.set("link",Array.from(S).join(", "))}N+=P.head;const J=n.templates.app({head:N,body:L,assets:C,nonce:z.nonce,env:q}),B=await w.transformPageChunk({html:J,done:!0})||"";return G||F.set("etag",`"${Me(B)}"`),G?new Response(new ReadableStream({async start(e){e.enqueue(v.encode(B+"\n"));for await(const t of G)t.length&&e.enqueue(v.encode(t));e.close()},type:"bytes"}),{headers:F}):t(B,{status:c,headers:F})}function ut(e){return function(t,r){if(t)for(const n in t){if("_"===n[0]||e.has(n))continue;const t=[...e.values()],s=dt(n,r?.slice(r.lastIndexOf(".")))??`valid exports are ${t.join(", ")}, or anything with a '_' prefix`;throw new Error(`Invalid export '${n}'${r?` in ${r}`:""} (${s})`)}}}function dt(e,t=".js"){const r=[];if(pt.has(e)&&r.push(`+layout${t}`),ht.has(e)&&r.push(`+page${t}`),ft.has(e)&&r.push(`+layout.server${t}`),mt.has(e)&&r.push(`+page.server${t}`),_t.has(e)&&r.push(`+server${t}`),r.length>0)return`'${e}' is a valid export in ${r.slice(0,-1).join(", ")}${r.length>1?" or ":""}${r.at(-1)}`}const pt=new Set(["load","prerender","csr","ssr","trailingSlash","config"]),ht=new Set([...pt,"entries"]),ft=new Set([...pt]),mt=new Set([...ft,"actions","entries"]),_t=new Set(["GET","POST","PATCH","PUT","DELETE","OPTIONS","HEAD","fallback","prerender","trailingSlash","config","entries"]),yt=ut(pt),gt=ut(ht),wt=ut(ft),vt=ut(mt);ut(_t);class bt{data;constructor(e){this.data=e}layouts(){return this.data.slice(0,-1)}page(){return this.data.at(-1)}validate(){for(const t of this.layouts())t&&(wt(t.server,t.server_id),yt(t.universal,t.universal_id));const e=this.page();e&&(vt(e.server,e.server_id),gt(e.universal,e.universal_id))}#m(e){return this.data.reduce((t,r)=>r?.universal?.[e]??r?.server?.[e]??t,void 0)}csr(){return this.#m("csr")??!0}ssr(){return this.#m("ssr")??!0}prerender(){return this.#m("prerender")??!1}trailing_slash(){return this.#m("trailingSlash")??"never"}get_config(){let e={};for(const t of this.data)(t?.universal?.config||t?.server?.config)&&(e={...e,...t?.universal?.config,...t?.server?.config});return Object.keys(e).length?e:void 0}should_prerender_data(){return this.data.some(e=>e?.server?.load||void 0!==e?.server?.trailingSlash)}}async function $t({event:e,event_state:t,options:r,manifest:n,state:s,status:o,error:i,resolve_opts:c}){if(e.request.headers.get("x-sveltekit-error"))return ne(r,o,i.message);const l=[];try{const a=[],u=await n._.nodes[0](),d=new bt([u]),p=d.ssr(),h=d.csr(),f=qe(e,t,r);if(p){s.error=!0;const r=Ne({event:e,event_state:t,state:s,node:u,parent:async()=>({})}),o=await r;f.add_node(0,o);const i=await Le({event:e,event_state:t,fetched:l,node:u,parent:async()=>({}),resolve_opts:c,server_data_promise:r,state:s,csr:h});a.push({node:u,server_data:o,data:i},{node:await n._.nodes[1](),data:null,server_data:null})}return await lt({options:r,manifest:n,state:s,page_config:{ssr:p,csr:h},status:o,error:await ae(e,t,r,i),branch:a,fetched:l,event:e,event_state:t,resolve_opts:c,data_serializer:f})}catch(u){return u instanceof a?oe(u.status,u.location):ne(r,B(u),(await ae(e,t,r,u)).message)}}async function kt(e,r,n,l,u,d,p,h){if(d.depth>10)return t(`Not found: ${e.url.pathname}`,{status:404});if(ve(e)){const t=await u._.nodes[n.leaf]();return async function(e,t,r,n){const i=n?.actions;if(!i){const n=new s(405,"Method Not Allowed","POST method not allowed. No form actions exist for this page");return ke({type:"error",error:await ae(e,t,r,n)},{status:n.status,headers:{allow:"GET"}})}Ee(i);try{const n=await je(e,t,i);return ke(n instanceof o?{type:"failure",status:n.status,data:Re(n.data,e.route.id,r.hooks.transport)}:{type:"success",status:n?200:204,data:Re(n,e.route.id,r.hooks.transport)})}catch(c){const n=c;return n instanceof a?$e(n):ke({type:"error",error:await ae(e,t,r,be(n))},{status:B(n)})}}(e,r,l,t?.server)}try{const m=p.page();let _,g=200;if(function(e){return"POST"===e.request.method}(e)){const t=e.url.searchParams.get("/remote");if(_=t?await async function(e,t,r,n){return we({name:"sveltekit.remote.form.post",attributes:{},fn:o=>{const l=c(e,o);return i({event:l,state:t},()=>async function(e,t,r,n){const[o,c,l]=n.split("/"),u=r._.remotes,d=await(u[o]?.());let p=d?.default[c];if(!p)return e.setHeaders({allow:"GET"}),{type:"error",error:new s(405,"Method Not Allowed","POST method not allowed. No form actions exist for this page")};l&&(p=i({event:e,state:t},()=>p.for(JSON.parse(l))));try{const r=await e.request.formData(),n=p.__.fn;return l&&!r.has("id")&&r.set("sveltekit:id",decodeURIComponent(l)),await i({event:e,state:t},()=>n(r)),{type:"success",status:200}}catch(h){const e=h;return e instanceof a?{type:"redirect",status:e.status,location:e.location}:{type:"error",error:be(e)}}}(l,t,r,n))}})}(e,r,u,t):await async function(e,t,r){const n=r?.actions;if(!n)return e.setHeaders({allow:"GET"}),{type:"error",error:new s(405,"Method Not Allowed","POST method not allowed. No form actions exist for this page")};Ee(n);try{const r=await je(e,t,n);return r instanceof o?{type:"failure",status:r.status,data:r.data}:{type:"success",status:200,data:r}}catch(i){const e=i;return e instanceof a?{type:"redirect",status:e.status,location:e.location}:{type:"error",error:be(e)}}}(e,r,m.server),"redirect"===_?.type)return oe(_.status,_.location);"error"===_?.type&&(g=B(_.error)),"failure"===_?.type&&(g=_.status)}const w=p.prerender();if(w){const e=m.server;if(e?.actions)throw new Error("Cannot prerender pages with actions")}else if(d.prerendering)return new Response(void 0,{status:204});d.prerender_default=w;const v=p.should_prerender_data(),b=fe(e.url.pathname),$=[],k=p.ssr(),E=p.csr();if(!(!1!==k||d.prerendering&&v))return y&&_&&e.request.headers.has("x-sveltekit-action"),await lt({branch:[],fetched:$,page_config:{ssr:!1,csr:E},status:g,error:null,event:e,event_state:r,options:l,manifest:u,state:d,resolve_opts:h,data_serializer:qe(e,r,l)});const j=[];let R=null;const x=qe(e,r,l),S=d.prerendering&&v?Oe(e,r,l):null,q=p.data.map((t,n)=>{if(R)throw R;return Promise.resolve().then(async()=>{try{if(t===m&&"error"===_?.type)throw _.error;const s=await Ne({event:e,event_state:r,state:d,node:t,parent:async()=>{const e={};for(let t=0;t<n;t+=1){const r=await q[t];r&&Object.assign(e,r.data)}return e}});return t&&x.add_node(n,s),S?.add_node(n,s),s}catch(s){throw R=s,R}})}),O=p.data.map((t,n)=>{if(R)throw R;return Promise.resolve().then(async()=>{try{return await Le({event:e,event_state:r,fetched:$,node:t,parent:async()=>{const e={};for(let t=0;t<n;t+=1)Object.assign(e,await O[t]);return e},resolve_opts:h,server_data_promise:q[n],state:d,csr:E})}catch(s){throw R=s,R}})});for(const e of q)e.catch(()=>{});for(const e of O)e.catch(()=>{});for(let s=0;s<p.data.length;s+=1){const o=p.data[s];if(o)try{const e=await q[s],t=await O[s];j.push({node:o,server_data:e,data:t})}catch(f){const o=J(f);if(o instanceof a){if(d.prerendering&&v){const e=JSON.stringify({type:"redirect",location:o.location});d.prerendering.dependencies.set(b,{response:t(e),body:e})}return oe(o.status,o.location)}const i=B(o),c=await ae(e,r,l,o);for(;s--;)if(n.errors[s]){const t=n.errors[s],a=await u._.nodes[t]();let o=s;for(;!j[o];)o-=1;x.set_max_nodes(o+1);const p=de(j.slice(0,o+1)),f=new bt(p.map(e=>e.node));return await lt({event:e,event_state:r,options:l,manifest:u,state:d,resolve_opts:h,page_config:{ssr:f.ssr(),csr:f.csr()},status:i,error:c,branch:p.concat({node:a,data:null,server_data:null}),fetched:$,data_serializer:x})}return ne(l,i,c.message)}else j.push(null)}if(d.prerendering&&S){let{data:e,chunks:r}=S.get_data();if(r)for await(const t of r)e+=t;d.prerendering.dependencies.set(b,{response:t(e),body:e})}return await lt({event:e,event_state:r,options:l,manifest:u,state:d,resolve_opts:h,page_config:{csr:E,ssr:k},status:g,error:null,branch:!1===k?[]:de(j),action_result:_,fetched:$,data_serializer:!1===k?qe(e,r,l):x})}catch(f){return await $t({event:e,event_state:r,options:l,manifest:u,state:d,status:500,error:f,resolve_opts:h})}}function Et(e,r=200){return t("string"==typeof e?e:JSON.stringify(e),{status:r,headers:{"content-type":"application/json","cache-control":"private, no-store"}})}function jt(e){return Et({type:"redirect",location:e.location})}const Rt=/[\x00-\x1F\x7F()<>@,;:"/[\]?={} \t]/;function xt(e){if(void 0===e?.path)throw new Error("You must specify a `path` when setting, deleting or serializing cookies")}function St(e,t){if(!t)return!0;const r="."===t[0]?t.slice(1):t;return e===r||e.endsWith("."+r)}function qt(e,t){if(!t)return!0;const r=t.endsWith("/")?t.slice(0,-1):t;return e===r||e.startsWith(r+"/")}function Ot(e,t){for(const r of t){const{name:t,value:n,options:s}=r;if(e.append("set-cookie",N(t,n,s)),s.path.endsWith(".html")){const r=fe(s.path);e.append("set-cookie",N(t,n,{...s,path:r}))}}}function Tt({event:e,options:t,manifest:r,state:n,get_cookie_header:s,set_internal:a}){return(o,i)=>{const c=(async(o,i)=>{const c=Pt(o,i,e.url);let l=(o instanceof Request?o.mode:i?.mode)??"cors",p=(o instanceof Request?o.credentials:i?.credentials)??"same-origin";return t.hooks.handleFetch({event:e,request:c,fetch:async(o,i)=>{const h=Pt(o,i,e.url),f=new URL(h.url);if(h.headers.has("origin")||h.headers.set("origin",e.url.origin),o!==c&&(l=(o instanceof Request?o.mode:i?.mode)??"cors",p=(o instanceof Request?o.credentials:i?.credentials)??"same-origin"),"GET"!==h.method&&"HEAD"!==h.method||("no-cors"!==l||f.origin===e.url.origin)&&f.origin!==e.url.origin||h.headers.delete("origin"),f.origin!==e.url.origin){if(`.${f.hostname}`.endsWith(`.${e.url.hostname}`)&&"omit"!==p){const e=s(f,h.headers.get("cookie"));e&&h.headers.set("cookie",e)}return fetch(h)}const m=u||d,_=decodeURIComponent(f.pathname),y=(_.startsWith(m)?_.slice(m.length):_).slice(1),g=`${y}/index.html`,w=r.assets.has(y)||y in r._.server_assets,v=r.assets.has(g)||g in r._.server_assets;if(w||v){const e=w?y:g;if(n.read){const t=w?r.mimeTypes[y.slice(y.lastIndexOf("."))]:"text/html";return new Response(n.read(e),{headers:t?{"content-type":t}:{}})}if(O&&e in r._.server_assets){const t=r._.server_assets[e],n=r.mimeTypes[e.slice(e.lastIndexOf("."))];return new Response(O(e),{headers:{"Content-Length":""+t,"Content-Type":n}})}return await fetch(h)}if(le(r,d+_))return await fetch(h);if("omit"!==p){const t=s(f,h.headers.get("cookie"));t&&h.headers.set("cookie",t);const r=e.request.headers.get("authorization");r&&!h.headers.has("authorization")&&h.headers.set("authorization",r)}h.headers.has("accept")||h.headers.set("accept","*/*"),h.headers.has("accept-language")||h.headers.set("accept-language",e.request.headers.get("accept-language"));const b=await async function(e,t,r,n){if(e.signal){if(e.signal.aborted)throw new DOMException("The operation was aborted.","AbortError");let s=()=>{};const a=new Promise((t,r)=>{const n=()=>{r(new DOMException("The operation was aborted.","AbortError"))};e.signal.addEventListener("abort",n,{once:!0}),s=()=>e.signal.removeEventListener("abort",n)}),o=await Promise.race([Wt(e,t,r,{...n,depth:n.depth+1}),a]);return s(),o}return await Wt(e,t,r,{...n,depth:n.depth+1})}(h,t,r,n),$=b.headers.get("set-cookie");if($)for(const e of L.splitCookiesString($)){const{name:t,value:r,...n}=L.parseString(e,{decodeValues:!1}),s=n.path??(f.pathname.split("/").slice(0,-1).join("/")||"/");a(t,r,{path:s,encode:e=>e,...n})}return b}})})(o,i);return c.catch(()=>{}),c}}function Pt(e,t,r){return e instanceof Request?e:new Request("string"==typeof e?new URL(e,r):e,t)}let At,Ut,Ct;const Ht=({html:e})=>e,Nt=()=>!1,Lt=({type:e})=>"js"===e||"css"===e,zt=new Set(["GET","HEAD","POST"]),It=new Set(["GET","HEAD","OPTIONS"]),Wt=(Dt=async function(o,l,u,h){const f=new URL(o.url),m=f.pathname.endsWith(me),_=(w=f.pathname).endsWith(pe)||w.endsWith(he),g=function(e){return e.pathname.startsWith(`${d}/${p}/remote/`)&&e.pathname.replace(`${d}/${p}/remote/`,"")}(f);var w;{const r=o.headers.get("origin");if(g){if("GET"!==o.method&&r!==f.origin)return e({message:"Cross-site remote requests are forbidden"},{status:403})}else if(l.csrf_check_origin&&F(o)&&("POST"===o.method||"PUT"===o.method||"PATCH"===o.method||"DELETE"===o.method)&&r!==f.origin&&(!r||!l.csrf_trusted_origins.includes(r))){const r=`Cross-site ${o.method} form submissions are forbidden`,n={status:403};return"application/json"===o.headers.get("accept")?e({message:r},n):t(r,n)}}if(l.hash_routing&&f.pathname!==d+"/"&&"/[fallback]"!==f.pathname)return t("Not found",{status:404});let b;m?f.pathname=function(e){return e.slice(0,-11)}(f.pathname):_?(f.pathname=function(e){return e.endsWith(he)?e.slice(0,-16)+".html":e.slice(0,-12)}(f.pathname)+("1"===f.searchParams.get(j)?"/":"")||"/",f.searchParams.delete(j),b=f.searchParams.get(R)?.split("").map(e=>"1"===e),f.searchParams.delete(R)):g&&(f.pathname=o.headers.get("x-sveltekit-pathname")??d,f.search=o.headers.get("x-sveltekit-search")??"");const $={},{cookies:x,new_cookies:S,get_cookie_header:O,set_internal:T,set_trailing_slash:P}=function(e,t){const r=e.headers.get("cookie")??"",n=H(r,{decode:e=>e});let s;const a=new Map,o={httpOnly:!0,sameSite:"lax",secure:"localhost"!==t.hostname||"http:"!==t.protocol},i={get(e,n){const s=Array.from(a.values()).filter(r=>r.name===e&&St(t.hostname,r.options.domain)&&qt(t.pathname,r.options.path)).sort((e,t)=>t.options.path.length-e.options.path.length)[0];return s?0===s.options.maxAge?void 0:s.value:H(r,{decode:n?.decode})[e]},getAll(e){const n=H(r,{decode:e?.decode}),s=new Map;for(const r of a.values())if(St(t.hostname,r.options.domain)&&qt(t.pathname,r.options.path)){const e=s.get(r.name);(!e||r.options.path.length>e.options.path.length)&&s.set(r.name,r)}for(const t of s.values())n[t.name]=t.value;return Object.entries(n).map(([e,t])=>({name:e,value:t}))},set(e,t,r){e.match(Rt),xt(r),l(e,t,{...o,...r})},delete(e,t){xt(t),i.set(e,"",{...t,maxAge:0})},serialize(e,r,n){xt(n);let a=n.path;if(!n.domain||n.domain===t.hostname){if(!s)throw new Error("Cannot serialize cookies until after the route is determined");a=Pe(s,a)}return N(e,r,{...o,...n,path:a})}},c=[];function l(e,r,n){if(!s)return void c.push(()=>l(e,r,n));let o=n.path;n.domain&&n.domain!==t.hostname||(o=Pe(s,o));const i=function(e,t,r){return`${e||""}${t}?${encodeURIComponent(r)}`}(n.domain,o,e),u={name:e,value:r,options:{...n,path:o}};a.set(i,u)}return{cookies:i,new_cookies:a,get_cookie_header:function(e,t){const r={...n};for(const n of a.values()){if(!St(e.hostname,n.options.domain))continue;if(!qt(e.pathname,n.options.path))continue;const t=n.options.encode||encodeURIComponent;r[n.name]=t(n.value)}if(t){const e=H(t,{decode:e=>e});for(const t in e)r[t]=e[t]}return Object.entries(r).map(([e,t])=>`${e}=${t}`).join("; ")},set_internal:l,set_trailing_slash:function(e){s=Ae(t.pathname,e),c.forEach(e=>e())}}}(o,f),A={prerendering:h.prerendering,transport:l.hooks.transport,handleValidationError:l.hooks.handleValidationError,tracing:{record_span:we},is_in_remote_function:!1},U={cookies:x,fetch:null,getClientAddress:h.getClientAddress||(()=>{throw new Error("@sveltejs/adapter-static does not specify getClientAddress. Please raise an issue")}),locals:{},params:{},platform:h.platform,request:o,route:{id:null},setHeaders:e=>{for(const t in e){const r=t.toLowerCase(),n=e[t];if("set-cookie"===r)throw new Error("Use `event.cookies.set(name, value, options)` instead of `event.setHeaders` to set cookies");if(r in $)throw new Error(`"${t}" header is already set`);$[r]=n,h.prerendering&&"cache-control"===r&&(h.prerendering.cache=n)}},url:f,isDataRequest:_,isSubRequest:h.depth>0,isRemoteRequest:!!g};U.fetch=Tt({event:U,options:l,manifest:u,state:h,get_cookie_header:O,set_internal:T}),h.emulator?.platform&&(U.platform=await h.emulator.platform({config:{},prerender:!!h.prerendering?.fallback}));let C=f.pathname;if(!g){const e=h.prerendering?.inside_reroute;try{h.prerendering&&(h.prerendering.inside_reroute=!0),C=await l.hooks.reroute({url:new URL(f),fetch:U.fetch})??f.pathname}catch{return t("Internal Server Error",{status:500})}finally{h.prerendering&&(h.prerendering.inside_reroute=e)}}try{C=function(e){return e.split("%25").map(decodeURI).join("%25")}(C)}catch{return t("Malformed URI",{status:400})}if(C!==f.pathname&&!h.prerendering?.fallback&&le(u,C)){const e=new URL(o.url);e.pathname=_?fe(C):m?_e(C):C;const t=await fetch(e,o),r=new Headers(t.headers);return r.has("content-encoding")&&(r.delete("content-encoding"),r.delete("content-length")),new Response(t.body,{headers:r,status:t.status,statusText:t.statusText})}let L=null;if(d&&!h.prerendering?.fallback){if(!C.startsWith(d))return t("Not found",{status:404});C=C.slice(d.length)||"/"}if(m)return async function(e,r,n){if(!n._.client.routes)return t("Server-side route resolution disabled",{status:400});let s=null,a={};const o=await n._.matchers();for(const t of n._.client.routes){const r=t.pattern.exec(e);if(!r)continue;const n=st(r,t.params,o);if(n){s=t,a=Ue(n);break}}return it(s,a,r,n).response}(C,new URL(o.url),u);if(C===`/${p}/env.js`)return function(e){return At??=`export const env=${JSON.stringify(q)}`,Ut??=`W/${Date.now()}`,Ct??=new Headers({"content-type":"application/javascript; charset=utf-8",etag:Ut}),e.headers.get("if-none-match")===Ut?new Response(void 0,{status:304,headers:Ct}):new Response(At,{headers:Ct})}(o);if(!g&&C.startsWith(`/${p}`)){const e=new Headers;return e.set("cache-control","public, max-age=0, must-revalidate"),t("Not found",{status:404,headers:e})}if(!h.prerendering?.fallback){const e=await u._.matchers();for(const t of u._.routes){const r=t.pattern.exec(C);if(!r)continue;const n=st(r,t.params,e);if(n){L=t,U.route={id:L.id},U.params=Ue(n);break}}}let z={transformPageChunk:Ht,filterSerializedResponseHeaders:Nt,preload:Lt},I="never";try{const p=L?.page?new bt(await function(e,t){return Promise.all([...e.layouts.map(e=>null==e?e:t._.nodes[e]()),t._.nodes[e.leaf]()])}(L.page,u)):void 0;if(L&&!g){if(f.pathname===d||f.pathname===d+"/")I="always";else if(p)I=p.trailing_slash();else if(L.endpoint){const e=await L.endpoint();I=e.trailingSlash??"never"}if(!_){const e=Ae(f.pathname,I);if(e!==f.pathname&&!h.prerendering?.fallback)return new Response(void 0,{status:308,headers:{"x-sveltekit-normalize":"1",location:(e.startsWith("//")?f.origin+e:e)+("?"===f.search?"":f.search)}})}if(h.before_handle||h.emulator?.platform){let e={},t=!1;if(L.endpoint){const r=await L.endpoint();e=r.config??e,t=r.prerender??t}else p&&(e=p.get_config()??e,t=p.prerender());h.before_handle&&h.before_handle(U,e,t),h.emulator?.platform&&(U.platform=await h.emulator.platform({config:e,prerender:t}))}}P(I),!h.prerendering||h.prerendering.fallback||h.prerendering.inside_reroute||Ce(f);const m=await we({name:"sveltekit.handle.root",attributes:{"http.route":U.route.id||"unknown","http.method":U.request.method,"http.url":U.url.href,"sveltekit.is_data_request":_,"sveltekit.is_sub_request":U.isSubRequest},fn:async d=>{const f={...U,tracing:{enabled:!1,root:d,current:d}};return await i({event:f,state:A},()=>l.hooks.handle({event:f,resolve:(d,f)=>we({name:"sveltekit.resolve",attributes:{"http.route":d.route.id||"unknown"},fn:m=>i(null,()=>async function(d,p,f){try{if(f&&(z={transformPageChunk:f.transformPageChunk||Ht,filterSerializedResponseHeaders:f.filterSerializedResponseHeaders||Nt,preload:f.preload||Lt}),l.hash_routing||h.prerendering?.fallback)return await lt({event:d,event_state:A,options:l,manifest:u,state:h,page_config:{ssr:!1,csr:!0},status:200,error:null,branch:[],fetched:[],resolve_opts:z,data_serializer:qe(d,A,l)});if(g)return await async function(t,o,l,u,d){return we({name:"sveltekit.remote.call",attributes:{},fn:p=>{const h=c(t,p);return i({event:h,state:o},()=>async function(t,o,c,l,u){const[d,p,h]=u.split("/"),f=l._.remotes;f[d]||r(404);const m=(await f[d]()).default[p];m||r(404);const _=m.__,y=c.hooks.transport;let g;t.tracing.current.setAttributes({"sveltekit.remote.call.type":_.type,"sveltekit.remote.call.name":_.name});try{if("query_batch"===_.type){if("POST"!==t.request.method)throw new s(405,"Method Not Allowed",`\`query.batch\` functions must be invoked via POST request, not ${t.request.method}`);const{payloads:r}=await t.request.json(),a=r.map(e=>k(e,y)),l=await i({event:t,state:o},()=>_.run(a)),u=await Promise.all(a.map(async(e,r)=>{try{return{type:"result",data:l(e,r)}}catch(a){return{type:"error",error:await ae(t,o,c,a),status:a instanceof n||a instanceof s?a.status:500}}}));return e({type:"result",result:E(u,y)})}if("form"===_.type){if("POST"!==t.request.method)throw new s(405,"Method Not Allowed",`\`form\` functions must be invoked via POST request, not ${t.request.method}`);if(!F(t.request))throw new s(415,"Unsupported Media Type",`\`form\` functions expect form-encoded data â€” received ${t.request.headers.get("content-type")}`);const r=await t.request.formData();g=JSON.parse(r.get("sveltekit:remote_refreshes")??"[]"),r.delete("sveltekit:remote_refreshes"),h&&r.set("sveltekit:id",decodeURIComponent(h));const n=_.fn,a=await i({event:t,state:o},()=>n(r));return e({type:"result",result:E(a,y),refreshes:a.issues?{}:await w(g)})}if("command"===_.type){const{payload:r,refreshes:n}=await t.request.json(),s=k(r,y),a=await i({event:t,state:o},()=>m(s));return e({type:"result",result:E(a,y),refreshes:await w(n)})}const r="prerender"===_.type?h:new URL(t.request.url).searchParams.get("payload"),a=await i({event:t,state:o},()=>m(k(r,y)));return e({type:"result",result:E(a,y)})}catch(v){if(v instanceof a)return e({type:"redirect",location:v.location,refreshes:await w(g??[])});const r=v instanceof n||v instanceof s?v.status:500;return e({type:"error",error:await ae(t,o,c,v),status:r},{status:o.prerendering?r:void 0,headers:{"cache-control":"private, no-store"}})}async function w(e){const n=o.refreshes??{};for(const s of e){if(void 0!==n[s])continue;const[e,a,c]=s.split("/"),u=l._.remotes[e],d=(await(u?.()))?.default?.[a];d||r(400,"Bad Request"),n[s]=i({event:t,state:o},()=>d(k(c,y)))}if(0!==Object.keys(n).length)return E(Object.fromEntries(await Promise.all(Object.entries(n).map(async([e,t])=>[e,await t]))),y)}}(h,o,l,u,d))}})}(d,A,l,u,g);if(L){const e=d.request.method;let t;if(_)t=await async function(e,t,r,o,i,c,l,u){if(!r.page)return new Response(void 0,{status:404});try{const d=[...r.page.layouts,r.page.leaf],p=l??d.map(()=>!0);let h=!1;const f=new URL(e.url);f.pathname=Ae(f.pathname,u);const m={...e,url:f},_=d.map((e,r)=>function(){let n,s=!1;return()=>s?n:(s=!0,n=(async()=>{try{if(h)return{type:"skip"};const n=null==e?e:await i._.nodes[e]();return Ne({event:m,event_state:t,state:c,node:n,parent:async()=>{const e={};for(let t=0;t<r;t+=1){const r=await _[t]();r&&Object.assign(e,r.data)}return e}})}catch(n){throw h=!0,n}})())}()),y=_.map(async(e,t)=>p[t]?e():{type:"skip"});let g=y.length;const w=await Promise.all(y.map((r,i)=>r.catch(async r=>{if(r instanceof a)throw r;return g=Math.min(g,i+1),{type:"error",error:await ae(e,t,o,r),status:r instanceof n||r instanceof s?r.status:void 0}}))),b=Oe(e,t,o);for(let e=0;e<w.length;e++)b.add_node(e,w[e]);const{data:$,chunks:k}=b.get_data();return k?new Response(new ReadableStream({async start(e){e.enqueue(v.encode($));for await(const t of k)e.enqueue(v.encode(t));e.close()},type:"bytes"}),{headers:{"content-type":"text/sveltekit-data","cache-control":"private, no-store"}}):Et($)}catch(d){const r=d;return r instanceof a?jt(r):Et(await ae(e,t,o,r),500)}}(d,A,L,l,u,h,b,I);else if(!L.endpoint||L.page&&!function(e){const{method:t,headers:r}=e.request;return!(!D.includes(t)||M.includes(t))||("POST"!==t||"true"!==r.get("x-sveltekit-action"))&&"text/html"!==G(e.request.headers.get("accept")??"*/*",["*","text/html"])}(d)){if(!L.page)throw new Error("Route is neither page nor endpoint. This should never happen");if(!p)throw new Error("page_nodes not found. This should never happen");if(zt.has(e))t=await kt(d,A,L.page,l,u,h,p,z);else{const r=new Set(It),n=await u._.nodes[L.page.leaf]();n?.server?.actions&&r.add("POST"),t="OPTIONS"===e?new Response(null,{status:204,headers:{allow:Array.from(r.values()).join(", ")}}):ee([...r].reduce((e,t)=>(e[t]=!0,e),{}),e)}}else t=await async function(e,t,r,n){const s=e.request.method;let o=r[s]||r.fallback;if("HEAD"===s&&!r.HEAD&&r.GET&&(o=r.GET),!o)return ee(r,s);const c=r.prerender??n.prerender_default;if(c&&(r.POST||r.PATCH||r.PUT||r.DELETE))throw new Error("Cannot prerender endpoints that have mutative methods");if(n.prerendering&&!n.prerendering.inside_reroute&&!c){if(n.depth>0)throw new Error(`${e.route.id} is not prerenderable`);return new Response(void 0,{status:204})}t.is_endpoint_request=!0;try{const r=await i({event:e,state:t},()=>o(e));if(!(r instanceof Response))throw new Error(`Invalid response from route ${e.url.pathname}: handler should return a Response object`);if(n.prerendering&&(!n.prerendering.inside_reroute||c)){const t=new Response(r.clone().body,{status:r.status,statusText:r.statusText,headers:new Headers(r.headers)});if(t.headers.set("x-sveltekit-prerender",String(c)),!n.prerendering.inside_reroute||!c)return t;t.headers.set("x-sveltekit-routeid",encodeURI(e.route.id)),n.prerendering.dependencies.set(e.url.pathname,{response:t,body:null})}return r}catch(l){if(l instanceof a)return new Response(void 0,{status:l.status,headers:{location:l.location}});throw l}}(d,A,await L.endpoint(),h);if("GET"===o.method&&L.page&&L.endpoint){const e=t.headers.get("vary")?.split(",")?.map(e=>e.trim().toLowerCase());e?.includes("accept")||e?.includes("*")||(t=new Response(t.body,{status:t.status,statusText:t.statusText,headers:new Headers(t.headers)}),t.headers.append("Vary","Accept"))}return t}if(h.error&&d.isSubRequest){const e=new Headers(o.headers);return e.set("x-sveltekit-error","true"),await fetch(o,{headers:e})}if(h.error)return t("Internal Server Error",{status:500});if(0===h.depth)return y&&d.url.pathname,await $t({event:d,event_state:A,options:l,manifest:u,state:h,status:404,error:new s(404,"Not Found",`Not found: ${d.url.pathname}`),resolve_opts:z});if(h.prerendering)return t("not found",{status:404});const m=await fetch(o);return new Response(m.body,m)}catch(m){return await se(d,A,l,m)}finally{d.cookies.set=()=>{throw new Error("Cannot use `cookies.set(...)` after the response has been generated")},d.setHeaders=()=>{throw new Error("Cannot use `setHeaders(...)` after the response has been generated")}}}(c(d,m),p,f).then(e=>{for(const t in $){const r=$[t];e.headers.set(t,r)}return Ot(e.headers,S.values()),h.prerendering&&null!==d.route.id&&e.headers.set("x-sveltekit-routeid",encodeURI(d.route.id)),m.setAttributes({"http.response.status_code":e.status,"http.response.body.size":e.headers.get("content-length")||"unknown"}),e}))})}))}});if(200===m.status&&m.headers.has("etag")){let e=o.headers.get("if-none-match");e?.startsWith('W/"')&&(e=e.substring(2));const t=m.headers.get("etag");if(e===t){const e=new Headers({etag:t});for(const t of["cache-control","content-location","date","expires","vary","set-cookie"]){const r=m.headers.get(t);r&&e.set(t,r)}return new Response(void 0,{status:304,headers:e})}}if(_&&m.status>=300&&m.status<=308){const e=m.headers.get("location");if(e)return jt(new a(m.status,e))}return m}catch(W){if(W instanceof a){const e=_||g?jt(W):L?.page&&ve(U)?$e(W):oe(W.status,W.location);return Ot(e.headers,S.values()),e}return await se(U,A,l,W)}},async(e,...t)=>Dt(e,...t));var Dt;function Mt(e,t,r){return Object.fromEntries(Object.entries(e).filter(([e])=>e.startsWith(t)&&(""===r||!e.startsWith(r))))}let Gt,Ft=null;class Jt{#_;#y;constructor(e){if(this.#_=T,this.#y=e,W){const e=this.respond.bind(this);this.respond=async(...t)=>{const{promise:r,resolve:n}=z(),s=Ft;return Ft=r,await s,e(...t).finally(n)}}}async init({env:e,read:t}){const{env_public_prefix:r,env_private_prefix:n}=this.#_;if(P(Mt(e,n,r)),A(Mt(e,r,n)),t){const e=e=>{const r=t(e);return r instanceof ReadableStream?r:new ReadableStream({async start(e){try{const t=await Promise.resolve(r);if(!t)return void e.close();const n=t.getReader();for(;;){const{done:t,value:r}=await n.read();if(t)break;e.enqueue(r)}e.close()}catch(t){e.error(t)}}})};C(e)}await(Gt??=(async()=>{try{const e=await U();this.#_.hooks={handle:e.handle||(({event:e,resolve:t})=>t(e)),handleError:e.handleError||(({status:e,error:t,event:r})=>{!function(e,t,r){r.request.method,r.url.pathname;404===e||t.stack}(e,t,r)}),handleFetch:e.handleFetch||(({request:e,fetch:t})=>t(e)),handleValidationError:e.handleValidationError||(({issues:e})=>({message:"Bad Request"})),reroute:e.reroute||(()=>{}),transport:e.transport||{}},e.transport&&Object.fromEntries(Object.entries(e.transport).map(([e,t])=>[e,t.decode])),e.init&&await e.init()}catch(e){throw e}})())}async respond(e,t){return Wt(e,this.#_,this.#y,{...t,error:!1,depth:0})}}export{Jt as Server};
